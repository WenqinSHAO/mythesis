\chapter{Conclusion}

\section{Thesis Summary}

This thesis is developed around a central pursuit of \textit{making better use of various network measurements to improving the transmission performance for stub ASes from the outbound perspective.}
We came up with methods that predictively select destination prefixes associated with large traffic volume through studies on the temporal dynamism of per prefix volume time series.
These methods allow traffic engineering operations to be focused only on these important targets while still cover a majority of traffic, hence improving the scalability of traffic engineering system.
Later on, we focus on latency measurements. 
We showcased and diagnosed some data quality issues previously unattended.
Guidelines to mitigate their impacts on data processing and route selection were discussed.
To better interpret performance measurements, we introduced changepoint analysis to the processing of RTT measurements, so that significant changes in path performance can be systematically detected and trigger route re-selection.
We built an evaluation framework to quantify the robustness and sensitivity of detection methods on typical RTT measurements.
Further, with the data transformation with changepoint analysis, we grouped together RTT measurements that experienced same RTT changes and inferred the network locations that potentially caused these changes. This visibility enables route optimization for prefixes that we were not able to measure directly.

\section{Contributions}

\subsection{Scalable prefix selection}
It is recommended and reasonable to perform traffic engineering only for destinations with import traffic volume. One key challenge is to efficiently predict the volume importance for a great amount of destination prefixes repeatedly.

We analyzed real traffic measurements from nine different networks located in five different countries to acquire a realistic view on the distribution of traffic volume associated with BGP prefixes, as well as its variation in time.   
We observed that the prefixes with most important accumulated volume over a week have relatively stable hourly volume. 
Based on this observation, we proposed three simple 
metrics (also easy to compute) to proactively select prefixes with important foreseeable traffic volume.
We demonstrated that the metrics we proposed lead to better volume coverage compared to the existing solutions, the Grey model.
%Furthermore, we evaluated the transmission performance for selected destination prefixes using different transit providers. We simulated as well a dynamic route decision algorithm. 
%The results showed that with even a fairly basic mechanism, the overall RTT performance could be improved by $20\%$ compared to the best available transit provider in some networks studied. 

\subsection{Data quality concerns}
We studies two data quality issues previously unattended. One comes from the RIPE Atlas measurement platform, the other is specific to path performance measurement involving multiple probes.

The problem with Atlas was that some data points were missing for measurements meant to be performed regularly.
We investigated all the available RIPE Atlas probes back then over one month. Only 60\% of v3 probes have complete measurement length. 
$2/3$ of missing segments occurred while probes remain connected. 
Half of these segments are no more than 2 measurements in length, and are thus likely to be caused by scheduling issues. However, around $25\%$ of them lasts long($\geq 1h$). 
To help advance the investigation, we share with the RIPE Atlas team all the long missing segments and concerned Atlas probes identified in the study.

When measuring the performance of an AS path, multiple hosts/Atlas probes in the same  prefix can be employed. We studied the difference among these measurements, the origin of these different and its impact on route selection.
We found out that RTT time series collected in this study demonstrate diverse variation shapes though one common AS path is measured.
We clustered these RTT time series to reveal their group structure by extracting several features as their data representation. 
Resulted clusters successfully separate noisy traces from smooth ones according to human intuition and expertise.
It confirmed that RTT measurements need to be ``cleaned'' before traffic engineering usages.
Furthermore, we located the occurring location of most variations in end-to-end RTT measurements by applying the same clustering methods to the first hops of traceroute measurements.
The results showed that most additional variations come from the access network in this specific case.

\subsection{Change detection for RTT measurements}

We introduced changepoint analysis to the interpretation of RTT measurements.
Automatically detected changes in path performance can potentially serve as a robust trigger to route re-selection.
The main challenge resides in knowing how well a method works for RTT measurements.
We henceforth devised an evaluation framework consisting of a carefully labelled 34,008-hour RTT dataset as ground truth and a scoring method tolerates slight time shifts. We further designed a data transformation adapted to RTT measurements to improve the detection sensitivity of some detection methods.

We as well detected path changes at AS and IP level to understand the network implication of detected RTT changes.
We correlated the detected RTT and path changes by establishing an one-to-one matching between them. 
We carefully investigated the sensitivity distinction across different change detection methods.
These results provide very first guild lines concerning the application of change detection to network performance measurements.


\subsection{Change location inference}
Detecting the cause of performance issue, such as congestion, in the middle of Internet has always been very challenging. 
Our approach relied on the massive measurements that are geographically distributed collected from RIPE Atlas. Basing on the assumption that RTT changes observed on multiple paths tend to occur on the intersecting parts, we developed a series of inference logic to narrow down the scope of potential causes under all possible topology layouts.
We built two interactive visualization tools to enable the demonstration of shared RTT changes and inferred caused data under a meaningful Internet topology context.


\chapter{Future works}
We attacked various topics regarding different measurements and methods in this thesis.
What we arrived at most of time is merely a beginning or an enabling step in the corresponding direction.
There is still a long journey ahead to fully address these issues so that some of the methodological propositions in this work become exploitable in real network operation.
We sketch the most important issues left open and discuss possible approaches to them when possible.

\section{Capture bursty traffic}
In Chapter~\ref{sec:pref_selec}, we showcased that the amount of traffic represented by selected prefixes is reversely correlated to the burstiness of traffic observed on the client network. How to anticipate the activity of those bursty destination prefixes is then essential to further improve the volume coverage of proposed prefix selection methods.

Understanding the nature of these bursty traffic would greatly help. However, such observation could be related to the business model of each network and thus very difficult to generalize. A possible approach would be introducing a communication channel between the applications generating these bursty traffic and the TE system residing on network layer, as people nowadays do in an \ac{SDN} fashion. In this way, the TE system could be informed in real-time or even in advance of the arrival of large amount of traffic and hence intentionally optimize the routing for it.

If the traffic is unintended by the network or untraceable, e.g. in the case of \ac{HP} leasing infrastructure to various entities, the above presented mechanism becomes inapplicable. It is then desired to first detect the presence of these bursty traffic and record its information over long term so that researchers can explore its activity patterns to figure out some sign of predictivity.

\section{One more data quality concerns}
We revealed differences among measurements toward multiple probes within a same BGP prefix in Chapter~\ref{sec:ripe_atlas}. The adopted clustering approach separated them into two groups, one with `noisy' time series and the other the with `smooth' ones. The inherent reason for such difference is the sub-prefix level path difference associated to these probes, e.g. some of these paths are congested while others are not.

Another data quality issue wherefrom rises: \textit{do the measured performance data indeed represent the actual traffic performance toward the same prefix on a given path}?
This question can be further split. 

First, \textit{are we measuring the `right' hosts within the destination prefixes?} The concern is already illustrated by the above discussed sub-prefix level path difference. Even if we measure certain hosts found in real traffic, they don't necessary speak for the rest destinations within the same prefix.
Therefore, the question is transformed into: \textit{Do we need to split BGP prefixes into finer pieces according to path and performance homogeneity? And how?}
As articulated in Chapter~\ref{sec:chap5_precision}, it is in general beneficial acquiring a visibility of finer granularity, since such information might help optimize certain cases otherwise deemed impossible.
However, such benefit comes with a cost. Intuitively, once has first to explore the sub-prefix structure seen from a certain client network, which is apparently not trivial.
\citet{Lee2016} explored such sub-prefix route difference. Their work can serve as starting point for further inspection.

Second, \textit{do we measure the traffic in the right way?} ICMP ping is known to have different queuing priority during forwarding compared to other traffic, thus might not represent the real traffic performance. However, TCP latency measurement is not perfect either. Increasing traffic nowadays is transported in QUIC which is UDP based.
Passive measurement could complement active probing. However, how to strike the balance between sampling rating and time resolution is tricky.
Application specific instrumentation can as well help. The key challenge consists in well defined and commonly accepted telemetry interface between various applications and the network operation system.

Third, \textit{actually routing traffic on a path might change the the performance previously perceived.} Previously, this interaction between traffic and performance is immediate on the transit links. That is why researchers optimized for cost and congestion avoidance on transit links the same time. Recently, this interaction is less likely to happen on well provisioned transit links but is still possible on some bottlenecks in the middle of Internet. Since the capacity of the bottleneck is not explicitly known and shared with other traffic, it becomes much more challenging to predict the change of path performance before moving the traffic.  

\section{Change detection for streaming data}
In Chapter~\ref{sec:cpt_rtt}, we examined and discussed the detection sensitivity of several changepoint analysis methods on RTT measurements. However, all of them are offline methods, which means they can only work on past measurements. Meanwhile, in real practice performance measurements are rather endless stream. An ideal detection method should work in an online fashion, that is to update incrementally moments of change as new data flow in. We made some premature efforts in that direction: \url{https://github.com/WenqinSHAO/path_change_alert.git}. We believe that the evaluation framework we devised in this work can help to identify the best online method for RTT measurements.
To evaluate online method, the delay of detection needs as well be considered in the scoring method.

\section{Congestion and path change}
Concerning the temporal correlation between RTT and path change moments, we received a request from one of our paper reviews to classify each RTT change into path change or congestion as its cause. We were unable to fulfill the request mainly because path measurements on the reverse direction were not available. Since not all the path changes could be identified, RTT changes unmatched to path changes in the forwarding direction were actually a mixture of congestion and reversed path induced ones.

However, we had the feeling that it is possible to tell path and congestion caused RTT change apart by merely looking at the shape of RTT time series. The rule of thumb was that if an RTT change was related to congestion, the RTT variation during the congested period was obviously more important. However, due to the coarse time resolution (minutes) and evolving congestion avoidance mechanism, that simple description on congestion related RTT variance change might not be determinant. Still, we finding it a promising direction to pursuit. Such technology might help deduce the presence of transient congestion in the middle of Internet by merely using end-to-end measurements.

\section{Handle topology shifts in RTT change cause inference} 
During RTT change location inference, a hidden assumption is that the underlying topology remain unchanged, which is not true all the time. We adopted a simple approximation that is to construct topology graph and perform RTT change cause inference day by day, knowing that the AS level path changes are rare. 
However, when AS level path changes doe happen within a day and cause RTT changes, current inference logic can not properly distinguish the cause being the topology shift or being congestion on a same link.
Moreover, the presence of AS level load balancing links causes topology changes on an even smaller time scale. 
How to correctly attribute RTT changes in these cases potentially needs data structure modification to encode topology changes in an efficient way and inference logic adaptation to the dynamically tie performance measurements to different underlying paths.

\section{RTT change location inference}
To achieve finer inference granularity, a more precise topology graph, e.g. \ac{PoP} level, will help. \url{http://popmap.io/} is a recent effort to follow in this direction.
Several improvements regarding measurements scoping are as well possible. In Chapter~\ref{sec:infer}, all the available Atlas probes were considered. It is not hard to notice that some of them were redundant.
The inference efficiency could be improved if we can fabricate a minimum set of measurements in achieving a specified topology coverage of inference.
Another application of such technique would be the calculation of the additional measurements required for node and links currently can not be (surely) inferred.
On the other hand, the presence of redundant measurements actually increases the statistical confidence of inference results. When redundant measurements do not harm to exist, it would be informative to express as well the confidence nuance across inference results.

\section{Route selection algorithm}
We have argued that changepoint analysis offers a robust data representation for RTT measurements by extracting only the moments of significant change. These moments are when route re-selection is potentially needed. It would be better if we propose a route selection algorithm based on change detection, evaluate its the performance gain and compare its gain to previous algorithms.
It would be even better if we could further incorporate RTT change location inference in route re-selection and demonstrate how much more traffic can hence be optimized.
One difficulty comes from the data collection on client networks, discussed in detail in Chapter~\ref{sec:ripe_atlas}. Meanwhile, emulating performance measurements via multiple transit providers seems not feasible with RIPE Atlas for the moment being.
 