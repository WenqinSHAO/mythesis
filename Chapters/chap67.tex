\chapter{Conclusion}

\section{Thesis Summary}

This thesis is developed around a central pursuit of \textit{making better use of various network measurements to improving the transmission performance for stub ASes from the outbound perspective.}

We came up with methods that predictively select destination prefixes associated with large traffic volume through studies on the temporal dynamism of per prefix volume time series.
These methods allow traffic engineering operations to be focused on only a few important targets while still cover a majority of traffic, hence improving the scalability of traffic engineering system.

Later on, we focused on latency measurements. 
We showcased and diagnosed some data quality issues previously unattended.
Guidelines to mitigate their impacts on data processing and route selection were discussed.

To better interpret performance measurements, we introduced changepoint analysis to the processing of RTT measurements, so that significant changes in path performance can be systematically detected and trigger route re-selection.
To enable further work in this direction, we built an evaluation framework quantifying the robustness and sensitivity of detection methods on typical RTT measurements.

Further, with the data transformation by changepoint analysis, we grouped together RTT measurements that experienced same RTT changes and inferred the network locations that potentially caused these changes. This visibility enables route optimization for prefixes that we were not able to measure directly.
To better illustrate the inference process and the identified causes for RTT change, we devised two interactive visualization tools to plot inference metrics and results on a topology graph learned through path measurements.

\section{Contributions}

\subsection{Scalable prefix selection}
It is recommended and reasonable to perform traffic engineering only for destinations with import traffic volume. One key challenge is to efficiently predict the volume importance for a great amount of destination prefixes repeatedly.

We analyzed real traffic measurements from nine different networks located in five different countries to acquire a realistic view on the distribution of traffic volume associated with BGP prefixes, as well as its variation in time.   
We observed that the prefixes with most important accumulated volume over a week have relatively stable hourly volume. 
Based on this observation, we proposed three simple 
metrics (also easy to compute) to proactively select prefixes with important foreseeable traffic volume.
We demonstrated that the metrics we proposed led to better volume coverage compared to the existing solutions, the Grey model.
%Furthermore, we evaluated the transmission performance for selected destination prefixes using different transit providers. We simulated as well a dynamic route decision algorithm. 
%The results showed that with even a fairly basic mechanism, the overall RTT performance could be improved by $20\%$ compared to the best available transit provider in some networks studied. 

\subsection{Data quality concerns}
We studies two data quality issues previously unattended. One comes from the RIPE Atlas measurement platform, the other is specific to path performance measurement involving multiple probes.

The problem with Atlas was that some data points were missing for measurements meant to be performed regularly.
After investigating all the available probes back then, we found that on a small fraction of probes, measurements were interrupted over a long duration while the probes remain well connected to the central controller.
This discovery indicated potential unknown issues with the measurement system.
To help advance the investigation, we shared with the RIPE Atlas team all the long missing segments and concerned Atlas probes identified in the study.

When measuring the performance of an AS path, multiple hosts/Atlas probes in a same  prefix can be employed. A specific dataset from Atlas revealed that a part of probes experienced additional delay changes originated from access network congestion when measuring on a same AS path.  A clear message from this study was to prefer RTT measurement with least additional variations, for a better representation of performance issues at AS level.

\subsection{Change detection for RTT measurements}

We introduced changepoint analysis to the interpretation of RTT measurements.
Automatically detected changes in path performance can potentially serve as a robust trigger to route re-selection.
The main challenge resides in knowing how well a method works for RTT measurements.
We henceforth devised an evaluation framework consisting of a carefully labelled 34,008-hour RTT dataset as ground truth and a scoring method tolerates slight time shifts. This framework paved the way for future studies in the domain, such as design online change detection methods for RTT measurements.

To understand the network implication of detected RTT changes, we correlated them to path change close in time.
This allowed us to investigate the sensitivity distinction across different change detection methods.

\subsection{Change location inference}
Detecting the cause of performance issue, such as congestion, in the middle of Internet has always been very challenging. 
Our approach relied on the massive measurements that are geographically distributed from RIPE Atlas. Basing on the assumption that RTT changes observed on multiple paths tend to occur on the intersecting parts, we developed a series of inference logic to narrow down the scope of potential causes under all possible topology layouts.
We built two interactive visualization tools to enable the demonstration of shared RTT changes and inferred causes under a meaningful Internet topology context.


\chapter{Future works}
We attacked various topics regarding different measurements and methods in this thesis.
What we arrived at most of time is merely a beginning or an enabling step to those directions.
There is still a long journey ahead.
% to fully address these issues so that some of the methodological propositions in this work become exploitable in real network operation.
We sketch the most important issues left open and discuss possible approaches to them when possible.

\iffalse
\section{One more data quality concerns}
We revealed differences among measurements toward multiple probes within a same BGP prefix in Chapter~\ref{sec:ripe_atlas}. The adopted clustering approach separated them into two groups, one with `noisy' time series and the other the with `smooth' ones. The inherent reason for such difference is the sub-prefix level path difference associated to these probes, e.g. some of these paths are congested while others are not.

Another data quality issue wherefrom rises: \textit{do the measured performance data indeed represent the actual traffic performance toward the same prefix on a given path}?
This question can be further split. 

First, \textit{are we measuring the `right' hosts within the destination prefixes?} The concern is already illustrated by the above highlighted sub-prefix level path difference. Even if we measure certain hosts found in real traffic, they don't necessary speak for the rest destinations within the same prefix.
Therefore, the question is transformed into: \textit{Do we need to split BGP prefixes into finer pieces according to path and performance homogeneity? And how?}
As articulated in Chapter~\ref{sec:chap5_precision}, it is in general beneficial acquiring a visibility of finer granularity, since such information might help optimize certain cases otherwise deemed impossible.
However, such benefit comes with a cost. Intuitively, once first has to explore the sub-prefix structure seen from a certain client network, which is apparently not trivial.
\citet{Lee2016} explored such sub-prefix route difference. Their work can serve as starting point for further inspection.

Second, \textit{do we measure the traffic in the right way?} ICMP ping is known to have different queuing priority during forwarding compared to other traffic, thus might not represent the real traffic performance. However, latency measurement via TCP SYN stealth is not perfect either. Increasing web traffic nowadays is transported in QUIC which is UDP based. Its queuing delay could thus differ from competing TCP connections on the same path.
Passive measurements are more faithful and could thus complement active probing. However, how to strike the balance between sampling rating and time resolution is tricky.
Application specific instrumentation can as well help. The key challenge consists in well defined and commonly accepted telemetry interface between various applications and the network operation system.


Third, \textit{actually routing traffic on a path might change the the performance previously perceived.} Previously, this interaction between traffic and performance is immediate on the transit links. That is why researchers optimized for cost and congestion avoidance on transit links the same time. Recently, this interaction is less likely to happen on well provisioned transit links but is still possible on some bottlenecks in the middle of Internet. Since the capacity of the bottleneck is not explicitly known and shared with other traffic, it becomes much more challenging to predict the change of path performance before actually moving the traffic.  
\fi


\section{Change detection for streaming data}
In Chapter~\ref{sec:cpt_rtt}, we examined and discussed the detection sensitivity of several changepoint analysis methods on RTT measurements. However, all of them are offline methods, which means they take in an entire time series and output at once all the moments of change identified in that time series.
Apparently, such methods can only be applied to past measurement records. 
While in real practice, performance measurements are rather endless streams, which requires change detection be done in an online fashion. It is worthy of noting that online detection is as well the basis for other directions that will be presented later on.

Online change detection updates incrementally moments of change as new data flow in.
If we apply repeatedly offline methods every time new measurement data is produced, an `online'-like effect can be achieved. However, as the length of data accumulates, the computational cost will become prohibitively high over time. Moreover, more and more resource is actually spent on detecting again and again changes previously detected.
To overcome these issues, we devised an adaptive way of using offline methods to lower down the computation to a practical level: \url{https://github.com/WenqinSHAO/path_change_alert.git}. 
In this proposition, we applied a sliding window to measurement streams. Change detection is only performed to the data within the window, thus the computational cost doesn't grow over time but rather limited by the window size. To further narrow down the scope, we retain only measurements afterwards once a changepoint is detected. It then suffices to detect the single most significant change moment at the arrival of new data.

The disadvantage of the above approach is two-fold. First, the window size needs to be properly tuned. The evaluation framework introduced in this thesis can help. Second, the computation of changepoints is not incremental, which leaves room for further performance improvements. Being incremental in calculation means that the detection method can learnt from the result of previous run and update it with only the new incoming datapoint to obtain the detection result of current run. Various methods~\cite{Caron2012,Turner2009a,Sharkey2014,Ho2014,Adams2007,Conditions2015} have been proposed. We can again employ the proposed evaluation framework to quantify the detection precision and relevance on RTT measurements with these methods.

Further, the scoring method used in the evaluation frameworks needs as well adaptation.
One fundamental feature of online methods is the delay of detection. It is the time between the actual occurrence of an change and the moment when the method successfully identify it as a change. Shorter delay suggests that a method is more reactive to changes and thus can leave more time for route optimization.

\section{Congestion and path change}
Concerning the temporal correlation between RTT and path change moments, we received a request from one of our paper reviews to classify each RTT change into path change or congestion as its cause. We were willing to but left unable to fulfill the request,  mainly because path measurements on the reverse direction were not available. Since not all the path changes could be identified, RTT changes unmatched to path changes in the forwarding direction were actually a mixture of congestion and reversed path induced ones. 

Nonetheless, a vague gauge was possible with Table~\ref{tab:corr_overview}.
If we boldly assume that path changes on reverse paths cause comparable amount of RTT changes as forwarding paths do, there are still a majority of RTT changes left unmatched to any path changes, thus potentially caused by congestion.

Another approach to address this problem would be identifying RTT changes caused by congestion directly, independent of path changes. 
With online change detection, it implies \texit{detecting in quasi realtime the occurrence of network congestion experienced by end-to-end measurements.}
Through visual inspection, e.g. Figure~\ref{fig:case_sensitivity}, we had the feeling that it might be possible to tell path and congestion caused RTT changes apart by merely looking at the shape of RTT time series. The rule of thumb was that if an RTT change was related to congestion, the RTT variation during the congested period was obviously more important. However, due to the coarse time resolution of available measurements (minutes) and evolving congestion avoidance mechanism, that simplistic description on RTT variance change is surly not determinant. Still, we find it a promising and meaningful direction to pursuit. Since such technology can help deduce the presence of transient congestion in the middle of Internet that current methods are not capable of~\cite{Luckie2014}.

\section{RTT change cause inference}
\paragraph*{Validation} What remains as well challenging is to validate those inferred causes of performance change. A possible approach would be developing a platform that pushes these inferred causes timely to those interested, potentially network administrators. Most importantly, the platform shall create a channel of feedback that allows us to learn the presence of false positive and false negative from those network administrators, with which further improvements on inference precision can be brought forth.

\paragraph*{Handle topology changes} During RTT change location inference, a hidden assumption is that the underlying topology remain unchanged, which is not always true. We adopted a simple approximation by constructing topology graph and performing RTT change cause inference day by day, knowing that the AS level path changes are rare. 
However, when AS level path changes do happen within a day and cause RTT changes, current inference logic can not properly distinguish the cause being the topology shift or congestion on a same link.
Moreover, the presence of AS level load balancing links causes topology changes on an even smaller time scale. 
How to correctly attribute RTT changes in these cases potentially needs data structure modification to encode topology changes in an efficient way.
Moreover, inference procedures need as well adaptation to dynamically tie performance measurements to different underlying paths then topology changes happen.

\paragraph*{Finer inference granularity} Through the case study in Chapter~\ref{sec:infer}, we realized that sub-AS level incident RTT changes can indeed happen and that current inference granularity is not sufficient to pinpoint them.
To achieve finer inference granularity, a more precise topology graph, e.g. \ac{PoP} level, will help. \url{http://popmap.io/} is a recent effort to follow in this direction.

\paragraph*{Measurement scoping} Several improvements regarding measurements scoping are as well possible. All the available Atlas probes were considered in the previous case study. It is not hard to notice that some of them were redundant.
The inference efficiency could be improved if we can fabricate a minimum set of measurements in achieving a specified topology coverage of inference.
Another application of such technique would be the calculation of the additional measurements required for node and links currently can not be (surely) inferred.
On the other hand, the presence of redundant measurements actually increases the statistical confidence of inference results. When redundant measurements do not harm to exist, it would be informative to express as well the confidence nuance across inference results.



\section{Route selection algorithm}
We have argued that changepoint analysis offers a robust data representation for RTT measurements by extracting only the moments of significant change. These moments are when route re-selection is potentially needed. It would be better if we actually propose a route selection algorithm basing on change detection, evaluate its the performance gain and compare its gain to previous algorithms.
It would be even better if we could further incorporate RTT change location inference in route re-selection and demonstrate how much more traffic can hence be optimized.
The evaluation of route selection mechanism requires end-to-end measurements via multiple providers.
Atlas falls short in providing such data.
Meanwhile, data collection from client networks remain challenging for reasons discussed in Chapter~\ref{sec:ripe_atlas}.
 